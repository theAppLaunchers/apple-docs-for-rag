

- Metal
-  Render Passes 

API Collection

# Render Passes

Encode a render pass to draw graphics into an image.

## Overview

A render pass processes and rasterizes geometry to one or more output attachments using a render pipeline.

Render passes consist of:

- A set of input resources, such as buffers and textures

- A render pipeline that configures the GPU that does work with the input resources

- Draw commands

- Vertex shaders, the GPU core functions that process and transform a scene’s geometry

- An optional tessellation stage that adds fine details to a scene’s geometry

- Fragment shaders, the GPU core functions that produce the final color values for each pixel

- Optional outputs that can include color, depth, and stencil attachments, and their load and store operations

See the Customizing Render Pass Setup sample for implementation details.

## Topics

### Encoding a Render Pass

protocol MTLRenderCommandEncoder

An interface that encodes a render pass into a command buffer, including all its draw calls and configuration.

enum MTLTriangleFillMode

Specifies how to rasterize triangle and triangle strip primitives.

enum MTLWinding

The vertex winding rule that determines a front-facing primitive.

enum MTLCullMode

The mode that determines whether to perform culling and which type of primitive to cull.

enum MTLPrimitiveType

The geometric primitive type for drawing commands.

enum MTLIndexType

The index type for an index buffer that references vertices of geometric primitives.

enum MTLDepthClipMode

The mode that determines how to deal with fragments outside of the near or far planes.

enum MTLVisibilityResultMode

The mode that determines what, if anything, the GPU writes to the results buffer, after the GPU executes the render pass.

### Encoding a Render Pass in Parallel

protocol MTLParallelRenderCommandEncoder

An object that splits up a single render pass so that it can be simultaneously encoded from multiple threads.

enum MTLLoadAction

Types of actions performed for an attachment at the start of a rendering pass.

enum MTLStoreAction

Types of actions performed for an attachment at the end of a rendering pass.

struct MTLStoreActionOptions

Options that modify a store action.

### Configuring a Render Command Encoder

class MTLRenderPassDescriptor

A group of render targets that hold the results of a render pass.

class MTLRenderPassAttachmentDescriptor

A render target that serves as the output destination for pixels generated by a render pass.

class MTLRenderPassColorAttachmentDescriptorArray

An array of render pass color attachment descriptor objects.

class MTLRenderPassColorAttachmentDescriptor

A color render target that serves as the output destination for color pixels generated by a render pass.

struct MTLClearColor

An RGBA value used for a color pixel.

class MTLRenderPassDepthAttachmentDescriptor

A depth render target that serves as the output destination for depth pixels generated by a render pass.

enum MTLMultisampleDepthResolveFilter

Filtering options for controlling an MSAA depth resolve operation.

class MTLTileRenderPipelineColorAttachmentDescriptorArray

An array of color attachment descriptors for the tile render pipeline.

class MTLRenderPassStencilAttachmentDescriptor

A stencil render target that serves as the output destination for stencil pixels generated by a render pass.

enum MTLMultisampleStencilResolveFilter

Constants used to control the multisample stencil resolve operation.

class MTLRenderPassSampleBufferAttachmentDescriptorArray

An array of sample buffer attachments for a render pass.

class MTLRenderPassSampleBufferAttachmentDescriptor

A description of where to store GPU counter information at the start and end of a render pass.

### Render Pipeline States

protocol MTLRenderPipelineState

An interface that represents a graphics pipeline configuration for a render pass, which the pass applies to the draw commands you encode.

class MTLRenderPipelineDescriptor

An argument of options you pass to a GPU device to get a render pipeline state.

class MTLRenderPipelineFunctionsDescriptor

A collection of functions for updating a render pipeline.

class MTLMeshRenderPipelineDescriptor

An object that configures new render pipeline state objects for mesh shading.

class MTLPipelineBufferDescriptor

The mutability options for a buffer that a render or compute pipeline uses.

class MTLPipelineBufferDescriptorArray

An array of pipeline buffer descriptors.

class MTLRenderPipelineColorAttachmentDescriptor

A color render target that specifies the color configuration and color operations for a render pipeline.

class MTLRenderPipelineColorAttachmentDescriptorArray

An array of render pipeline color attachment descriptor objects.

class MTLTileRenderPipelineDescriptor

An object that configures new render pipeline state objects for tile shading.

class MTLTileRenderPipelineColorAttachmentDescriptor

A description of a tile-shading render pipeline’s color render target.

struct MTLPipelineOption

Options that determine how Metal prepares the pipeline.

### Dynamic Render Pipeline States

struct MTLViewport

A 3D rectangular region for the viewport clipping.

struct MTLScissorRect

A rectangle for the scissor fragment test.

struct MTLVertexAmplificationViewMapping

An offset applied to a render target index and viewport index.

struct MTLQuadTessellationFactorsHalf

The per-patch tessellation factors for a quad patch.

struct MTLTriangleTessellationFactorsHalf

The per-patch tessellation factors for a triangle patch.

### Render Pass Inputs

class MTLVertexDescriptor

An object that describes how to organize and map data to a vertex function.

class MTLVertexAttributeDescriptor

An object that determines how to store attribute data in memory and map it to the arguments of a vertex function.

class MTLVertexAttributeDescriptorArray

An array of vertex attribute descriptor objects.

class MTLVertexBufferLayoutDescriptor

An object that configures how a render pipeline fetches data to send to the vertex function.

class MTLVertexBufferLayoutDescriptorArray

An array of vertex buffer layout descriptor objects.

let MTLBufferLayoutStrideDynamic: Int

### Render Pass Outputs

protocol MTLDrawable

A displayable resource that can be rendered or written to.

typealias MTLDrawablePresentedHandler

A block of code invoked after a drawable is presented.

### Depth Testing

Calculating Primitive Visibility Using Depth Testing

Determine which pixels are visible in a scene by using a depth texture.

protocol MTLDepthStencilState

A depth and stencil state object that specifies the depth and stencil configuration and operations used in a render pass.

class MTLDepthStencilDescriptor

An object that configures new MTLDepthStencilState objects.

class MTLStencilDescriptor

An object that defines the front-facing or back-facing stencil operations of a depth and stencil state object.

### Rasterization Settings

Rendering at Different Rasterization Rates

Configure a rasterization rate map to vary rasterization rates depending on the amount of detail needed.

Creating a Rasterization Rate Map

Define the rasterization rates for each part of your render target.

Rendering with a Rasterization Rate Map

Create offscreen textures to hold intermediate rasterized data.

Scaling Variable Rasterization Rate Content

Use the rate map data to scale the content to fill your destination texture.

class MTLRasterizationRateMapDescriptor

An object that you use to configure new rasterization rate maps.

protocol MTLRasterizationRateMap

A compiled read-only object that determines how to apply variable rasterization rates when rendering.

typealias MTLCoordinate2D

A coordinate in the viewport.

func MTLCoordinate2DMake(Float, Float) -> MTLCoordinate2D

Returns a new 2D point with the specified coordinates.

### Optimizing Techniques

Specifying Drawing and Dispatch Arguments Indirectly

Use indirect commands if you don’t know your draw or dispatch call arguments when you encode the command.

Rendering to Multiple Viewports in a Draw Command

Select viewports and their corresponding scissor rectangles in your vertex shader.

Rendering to Multiple Texture Slices in a Draw Command

Select a destination texture slice in your vertex shader.

### Advanced Multisampling

Positioning Samples Programmatically

Configure the position of samples when rendering to a multisampled render target.

Storing Data a Pass Makes with Custom Sample Positions for a Subsequent Pass

Inform Metal when your app uses programmable sample positions for its depth render targets or copies MSAA depth data.

### Applying Rendering Techniques

Using a Render Pipeline to Render Primitives

Render a simple 2D triangle.

Customizing Render Pass Setup

Render into an offscreen texture by creating a custom render pass.

Setting Load and Store Actions

Set actions that define how a render pass loads and stores a render target.

Improving Rendering Performance with Vertex Amplification

Run draw commands that render to different outputs using the same vertex data multiple times.

## See Also

### Command Encoders

Compute Passes

Encode a compute pass that runs computations in parallel on a thread grid, processing and manipulating Metal resource data on multiple cores of a GPU.

Blit Passes

Encode a block information transfer pass to adjust and copy data to and from GPU resources, such as buffers and textures.

Indirect Command Encoding

Store draw commands in Metal buffers and run them at a later time on the GPU, either once or repeatedly.

Ray Tracing with Acceleration Structures

Build a representation of your scene’s geometry using triangles and bounding volumes to quickly trace rays through the scene.

